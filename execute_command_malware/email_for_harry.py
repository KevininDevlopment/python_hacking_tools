#!/usr/bin/python3

""""
    <EmailingHarry is a python class that can be used to make certain that Harry Potter receives his acceptance
    letter into Hogwarts.>

    Copyright (C) <2020>  <Kevin Amaya>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

    DISCLAIMER
    The creator of this software is not responsible for how others may use it. Please use this
    software responsibly and only when given consent to do so.
"""

import smtplib
import time


class EmailingHarry:
    def __init__(self, server, port, email, password, receiver, message, num):
        self.server = server
        self.port = port
        self.email = email
        self.password = password
        self.receiver = receiver
        self.message = message
        self.num = num

    def sending_process(self):
        return self.server.sendmail(self.email, self.receiver, self.message)

    def now_sending(self):
        for i in range(self.num):
            self.sending_process()

    def email_sending(self):
        logging = self.num
        try:
            self.server = smtplib.SMTP(self.server, self.port)
            self.server.starttls()
            self.server.login(self.email, self.password)
            while True:
                self.now_sending()
                print("Successfully sent: " + str(logging) + " emails")
                logging = logging + logging
                # time.sleep(5)   #| Optional
                # self.server.quit()  | Optional
        except Exception as e:
            print(e)


""" 
-------------------------------------------------------------------------------------------------------------------
Example usage of this class:
-------------------------------------------------------------------------------------------------------------------
time_for_emails = EmailingHarry("smtp email", port, 'login email', "login password",
                              "Harry's email address", "message", number of emails to send Harry)
time_for_emails.email_sending()
--------------------------------------------------------------------------------------------------------------------
"""
